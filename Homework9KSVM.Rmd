---
title: ""
output: html_notebook
---
```{r}
data("airquality")
```

```{r}
airq <- airquality[complete.cases(airquality),]
```

```{r}
rand_index <- sample(1:dim(airq)[1])
```
```{r}
summary(rand_index)
```

```{r}
cut_2_3 <- floor(2 * dim(airq)[1] / 3)
```

```{r}
train_q <- airq[rand_index[1:cut_2_3],]
```

```{r}
pred_q <- airq[rand_index[(cut_2_3 + 1) : dim(airq)[1]], ]
```

```{r}
svm_output <- ksvm(Ozone ~ ., data = train_q, kernel = "rbfdot", kpar = "automatic", C = 5, cross = 3, prob.model = TRUE)
svm_output
```

```{r}
svm_output <- ksvm(Ozone ~ ., data = train_q, kernel = "rbfdot", kpar = "automatic", C = 50, cross = 3, prob.model = TRUE)
svm_output
```

```{r}
svm_output <- ksvm(Ozone ~ ., data = train_q, kernel = "rbfdot", kpar = "automatic", C = 3, cross = 3, prob.model = TRUE)
svm_output
```

```{r}
svm_output <- ksvm(Ozone ~ ., data = train_q, kernel = "rbfdot", kpar = "automatic", C = 500000, cross = 3, prob.model = TRUE)
svm_output
hist(alpha(svm_output)[[1]])
```

```{r}
svm_pred <- predict(svm_output, airq, type = "votes")
```

```{r}
str(svm_pred)
```

```{r}
pred_table <- data.frame(airq[,1], svm_pred[,1])
table(pred_table)
```

```{r}
pred_table$residuals <- (pred_table$airq...1. - pred_table$svm_pred...1.)
```

```{r}
max(pred_table$residuals)
min(pred_table$residuals)
median(pred_table$residuals)
plot(pred_table$residuals)
```

